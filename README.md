dist_acct['contact_dt'] = pd.to_datetime(dist_acct['contact_dt'])
call['workload_dt'] = pd.to_datetime(call['workload_dt'])
merged_df = dist_acct.merge(call, how='left', left_on=['loan_acct_nbr'], right_on=['loan_acct_nbr'])
merged_df['contact_dt_plus_7'] = merged_df['contact_dt'] + pd.Timedelta("7 days")
call_df = (merged_df.query('workload_dt >= contact_dt and workload_dt <= contact_dt_plus_7') .groupby(['loan_acct_nbr', 'contact_dt']) .agg(sum_call=('sum_call', 'sum')) .reset_index())
