data exp2;
    set exp1;
    format fake_equity_risk_erp $20.;
    drop var1;
    rand = input(random_num, best.);
    
    /* Determine fake_equity_risk_erp */
    if rand >= 80 then fake_equity_risk_erp = 'F2: High';
    else fake_equity_risk_erp = 'F1: Low';
	if pay_grp = 'high' then pay_grp2 = 'P1: High'; 
	else if pay_grp = 'med' then pay_grp2 = 'P2: Med';
	else pay_grp2 = 'P3: Low';
    
    /* Filter based on day_key */
    where day_key >= 20231001;

    /* Set holdout based on exp_grp, dpd, fake_equity_risk_grp, and pay_grp */
    if exp_grp = 'control' then holdout = 0;
    else if exp_grp = 'test0' then do;
        if dpd in (46, 51, 56) then holdout = 1;
        else holdout = 0;
    end;
    else if exp_grp = 'test1' then do;
        if fake_equity_risk_erp = 'low' then do;
            if pay_grp = 'high' then do;
                if dpd in (46, 48, 50, 52, 54, 56, 58) then holdout = 1;
                else holdout = 0;
            end;
            else if pay_grp = 'med' then do;
                if dpd in (47, 49, 51, 53, 55) then holdout = 1;
                else holdout = 0;
            end;
            else if pay_grp = 'low' then do;
                if dpd in (46, 48, 50, 52) then holdout = 1;
                else holdout = 0;
            end;
        end;
        else if fake_equity_risk_erp = 'high' then do;
            if pay_grp = 'high' then do;
                if dpd in (47, 51, 57) then holdout = 1;
                else holdout = 0;
            end;
            else if pay_grp = 'med' then do;
                if dpd in (46, 52) then holdout = 1;
                else holdout = 0;
            end;
            else if pay_grp = 'low' then do;
                if dpd in (50) then holdout = 1;
                else holdout = 0;
            end;
        end;
    end;
    else if exp_grp = 'test2' then do;
        if fake_equity_risk_erp = 'low' then do;
            if pay_grp = 'high' then do;
                if dpd in (47, 49, 51, 53, 56, 57) then holdout = 1;
                else holdout = 0;
            end;
            else if pay_grp = 'med' then do;
                if dpd in (48, 50, 52, 54, 56, 57) then holdout = 1;
                else holdout = 0;
            end;
            else if pay_grp = 'low' then do;
                if dpd in (47, 49, 51, 53, 56, 57, 58) then holdout = 1;
                else holdout = 0;
            end;
        end;
        else if fake_equity_risk_erp = 'high' then do;
            if pay_grp = 'high' then do;
                if dpd in (50, 54) then holdout = 1;
                else holdout = 0;
            end;
            else if pay_grp = 'med' then do;
                if dpd in (54, 55) then holdout = 1;
                else holdout = 0;
            end;
            else if pay_grp = 'low' then do;
                if dpd in (54, 55, 56) then holdout = 1;
                else holdout = 0;
            end;
        end;
    end;
run;
